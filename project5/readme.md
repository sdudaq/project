# SM2 数字签名算法（Python 实现）

本项目提供了基于国密 SM2 椭圆曲线密码算法的**纯 Python 实现**，包括签名和验证功能，并附带优化版本以提升性能和安全性。

## 项目介绍

SM2 是中国国家密码管理局制定的椭圆曲线公钥密码算法，广泛应用于电子认证和数字签名场景。本项目提供两种版本的实现：

- `SM2`：基础实现，便于理解算法原理；
- `SM2_Optimized`：包含多个性能和安全性优化点，适合实际应用测试。
## 项目结构

├── sm2_basic.py     # 基础版实现（仿射坐标）
├── sm2_optimized.py # 优化版实现（Jacobian坐标 + secrets）
├── README.md        # 本说明文件

## 依赖环境

- Python 3.6+
- `gmssl`库用于 SM3 哈希计算

安装依赖：

```bash
pip install gmssl

```

## SM2 签名流程

###  密钥生成

1. 随机选择私钥 d ∈ [1, n - 1]
2. 计算公钥 P = [d]G

---

###  签名过程

给定消息 M，签名流程如下：

1. 消息哈希：使用 SM3 哈希算法计算  
   e = Hash(M)

2. 随机选取整数  
   k ∈ [1, n - 1]

3. 计算椭圆曲线点  
   (x1, y1) = [k]G

4. 计算  
   r = (e + x1) mod n  
   若 r = 0 或 r + k = n，重新选择 k

5. 计算  
   s = ((1 + d)^(-1) * (k - r * d)) mod n  
   若 s = 0，重新选择 k

6. 签名结果为：  
   (r, s)

---

###  验证过程

给定消息 M 和签名 (r, s)，验证流程如下：

1. 计算消息哈希  
   e = Hash(M)

2. 计算  
   t = (r + s) mod n  
   若 t = 0，签名无效

3. 计算椭圆曲线点  
   (x1, y1) = [s]G + [t]P

4. 验证是否满足：  
   R = (e + x1) mod n = r  
   若相等，则签名有效。
