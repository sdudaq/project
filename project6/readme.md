# Project 6: Google Password Checkup 实现

## Private Set Intersection-Sum Protocol (PSI-Sum)
1. 协议概述
协议实现了一个基于DDH假设的隐私保护集合交集求和协议(PSI-Sum)，允许两方在不泄露各自完整数据集的情况下，计算双方数据的交集，并对交集项在P2中的关联值求和。
2. 协议原理
### 2.1 问题定义
给定：
P1：集合 V = {v₁, v₂, ..., vₘ₁}，其中 vᵢ ∈ U (标识符空间)
P2：集合 W = {(w₁, t₁), (w₂, t₂), ..., (wₘ₂, tₘ₂)}，其中 wⱼ ∈ U，tⱼ ∈ ℤ⁺
目标：
计算 V ∩ W (交集)
计算 ∑{tⱼ | (wⱼ, tⱼ) ∈ W 且 wⱼ ∈ V}
### 2.2 协议设计原理
协议基于以下密码学技术：

​​DDH假设​​：在素数阶群中，区分(gᵃ, gᵇ, gᵃᵇ)和(gᵃ, gᵇ, gᶜ)是困难的
​​加法同态加密​​：支持对加密数据进行加法运算
​​随机预言机模型​​：哈希函数H:U→G被视为随机预言机
### 2.3 数学公式解释
#### 哈希到群​​：
``` math
H: U → G
h = H(v) = SHA256(v) mod p
```
将任意标识符映射到群G中的随机元素
​​双盲化过程​​：
P1计算: H(v)ᵏ¹ mod p
P2计算: (H(v)ᵏ¹)ᵏ² = H(v)ᵏ¹ᵏ² mod p
通过双方私钥k₁,k₂实现双重盲化
​​交集判断​​：
J = {j | H(wⱼ)ᵏ¹ᵏ² ∈ Z}
其中Z是P2返回的盲化集合
​​同态求和​​：
Sⱼ = Σ tⱼ (对j ∈ J)